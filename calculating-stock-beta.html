<!DOCTYPE html>
<html lang="en">

<head>
  <link rel="stylesheet/less" type="text/css" href="./theme/css/style.less">
  <script src="./theme/js/less-1.5.0.min.js" type="text/javascript"></script>
  <!-- <link rel="stylesheet" type="text/css" href="./theme/css/style.css"> -->

  <link rel="stylesheet" type="text/css" href="./theme/css/pygments.css">
  <!--link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=PT+Sans|PT+Serif|PT+Mono"-->
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:800,400,300|Inconsolata' rel='stylesheet' type='text/css'>

  <!-- meta tags -->
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index,follow" />
  <meta name="generator" content="." />
  <meta name="author" content="Gouthaman Balaraman">
  <meta name="description" content="Introduction to calculating Beta, Alpha and R-squared for a stock. This article
will also include a python code snippet to calculate these measures.">
  <meta property="og:locale" content="en_US" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Stock Time Series Analytics" />
  <meta property="og:description" content= "Introduction to calculating Beta, Alpha and R-squared for a stock. This article
will also include a python code snippet to calculate these measures." />
  <meta property="og:url" content= "calculating-stock-beta.html" />
  <meta name="keywords" content="investment, stock beta">

  <meta property="og:locale" content="en_US" />

  <title>
Stock Time Series Analytics  </title>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46714334-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
</head>

<body>
  <aside>
    <div id="user_meta">
	<center>
      <a href=".">
        <img src="./theme/images/logo.png" alt="logo">
      </a>
      <h2><a href=".">Karuth</a></h2>
	  
      <p></p>
      <ul>
        <li><a href="./pages/about.html">About</a></li>
        <a href="https://twitter.com/quantspeak" class="twitter-follow-button" data-show-count="false" data-show-screen-name="false">Follow @quantspeak</a>
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
      </ul>
	  </center>
    </div>
  </aside>

  <main>
    <header>
      <p>
      <a href=".">Index</a> &#124; <a href="./archives.html">Archives</a>
      </p>
    </header>

<article>
  <div class="article_title">
    <h1><a href="./calculating-stock-beta.html">Stock Time Series Analytics</a></h1>
  </div>
  <div class="article_credits">
     Published January 09, 2014 By Gouthaman Balaraman
  </div>
  <div class="article_text">
    <p>Have you ever wondered how to calculate the Beta value that is shown in
<a class="reference external" href="http://www.google.com/finance">GoogleFinance</a> or <a class="reference external" href="http://www.finance.yahoo.com/">YahooFinance</a> and what does it mean from an investment perspective?
This article will give you an introduction to the concept and demonstrate how
you can calculate various time series measures for a stock using python.</p>
<div class="section" id="beta-alpha-and-r-squared">
<h2>Beta, Alpha and R-squared</h2>
<p>Beta of a stock is a measure of relative risk of the stock with respect to the market.
The convention (though not a rule) is to use S&amp;P 500 index as the proxy for market.
A beta value of greater than 1 means that the stock returns amplify the market returns
on both the upside and downside. On the contrary, a beta value of less than 1 means
that the stock returns are subdued in comparison to the market returns.
It is very important to understand that beta is a relative measure of risk, and
not an absolute measure of risk. That means that we are only saying how risky the stock is
vis-a-vis the market. If the stock market itself is overheated and volatile, then
a beta of 1 means that the stock is equally volatile, and equally risky.</p>
<p>The beta is calculated using regression analysis. In simple terms if you plot
the returns of stock as a function of the returns of the market benchmark (such as S&amp;P 500)
and fit it with a straight line, then beta is nothing but the slope of the fitted line.
The regression equation is given as shown below.</p>
<div class="formula">
<i>R</i><sub><i>stock</i></sub> = <i>α</i> + <i>β</i> × <i>R</i><sub><i>market</i></sub> + <i>ϵ</i>
</div>
<p>In Capital Asset Pricing Model, the returns of the stock <span class="formula"><i>R</i><sub><i>stock</i></sub></span>

and that of the market <span class="formula"><i>R</i><sub><i>market</i></sub></span>
 are adjusted for the risk-free
rate. Here for simplicity I leave that out. Given the current low interest rate
environment, this adjustment will add little value.</p>
<p>Alpha of a stock gives you a measure of the excess return with respect to the benchmark.
A positive alpha for a stock or portfolio gives you sense of how well your asset
outperformed a benchmark.</p>
<p>R-squared is a measure of how well the the returns of a stock is explained by the
returns of the benchmark. If your investment goal is to track a particular index,
then you should chose stocks that show a high R-squared with respect to that index.
R-squared value of 1 means a perfect correlation with the index, while a value of 0
means no correlation whatsoever.</p>
</div>
<div class="section" id="volatility-and-momentum">
<h2>Volatility and Momentum</h2>
<p>The measures discussed in the earlier section are what I would call <em>relative
measures</em>, i.e., they are with respect to a proxy that is a representation of
market. Time series measures such as volatility and momentum are what I would
call <em>innate measures</em>.</p>
<p>Volatility is nothing but the standard deviation of the returns of the stock.
It gives us a sense of how much the stock returns fluctuate and how risky it is.
High volatile stocks have high risk, and also have the potential to offer higher
returns. A 3-year history of 1-month returns can be a good sample to calculate
volatility.</p>
<p>Momentum is a measure of the past returns over a certain period. The 1-year
momentum will be the 1-year return of the stock, where as a 3-year momentum
will be the 3-year return of the stock.</p>
</div>
<div class="section" id="python-code">
<h2>Python Code</h2>
<p>One can use data from yahoo finance to calculate the stock beta as shown:</p>
<pre class="code python literal-block">
<span class="kn">from</span> <span class="nn">pandas.io.data</span> <span class="kn">import</span> <span class="n">DataReader</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="c"># Grab time series data for 5-year history for the stock (here AAPL)</span>
<span class="c"># and for S&amp;P-500 Index</span>
<span class="n">sdate</span>           <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2008</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="n">edate</span>           <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">31</span><span class="p">)</span>
<span class="n">df</span>              <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s">'AAPL'</span><span class="p">,</span><span class="s">'yahoo'</span><span class="p">,</span><span class="n">sdate</span><span class="p">,</span><span class="n">edate</span><span class="p">)</span>
<span class="n">dfb</span>             <span class="o">=</span> <span class="n">DataReader</span><span class="p">(</span><span class="s">'^GSPC'</span><span class="p">,</span><span class="s">'yahoo'</span><span class="p">,</span><span class="n">sdate</span><span class="p">,</span><span class="n">edate</span><span class="p">)</span>

<span class="c"># create a time-series of monthly data points</span>
<span class="n">rts</span>             <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'M'</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'last'</span><span class="p">)</span>
<span class="n">rbts</span>            <span class="o">=</span> <span class="n">dfb</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s">'M'</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s">'last'</span><span class="p">)</span>
<span class="n">dfsm</span>            <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s">'s_adjclose'</span> <span class="p">:</span> <span class="n">rts</span><span class="p">[</span><span class="s">'Adj Close'</span><span class="p">],</span>
                        <span class="s">'b_adjclose'</span> <span class="p">:</span> <span class="n">rbts</span><span class="p">[</span><span class="s">'Adj Close'</span><span class="p">]},</span>
                        <span class="n">index</span><span class="o">=</span><span class="n">rts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

<span class="c"># compute returns</span>
<span class="n">dfsm</span><span class="p">[[</span><span class="s">'s_returns'</span><span class="p">,</span><span class="s">'b_returns'</span><span class="p">]]</span> <span class="o">=</span> <span class="n">dfsm</span><span class="p">[[</span><span class="s">'s_adjclose'</span><span class="p">,</span><span class="s">'b_adjclose'</span><span class="p">]]</span><span class="o">/</span> \
    <span class="n">dfsm</span><span class="p">[[</span><span class="s">'s_adjclose'</span><span class="p">,</span><span class="s">'b_adjclose'</span><span class="p">]]</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">dfsm</span>            <span class="o">=</span> <span class="n">dfsm</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

<span class="n">covmat</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cov</span><span class="p">(</span><span class="n">dfsm</span><span class="p">[</span><span class="s">&quot;s_returns&quot;</span><span class="p">],</span><span class="n">dfsm</span><span class="p">[</span><span class="s">&quot;b_returns&quot;</span><span class="p">])</span>

<span class="c"># calculate measures now</span>
<span class="n">beta</span>            <span class="o">=</span> <span class="n">covmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">covmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">alpha</span>           <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dfsm</span><span class="p">[</span><span class="s">&quot;s_returns&quot;</span><span class="p">])</span><span class="o">-</span><span class="n">beta</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dfsm</span><span class="p">[</span><span class="s">&quot;b_returns&quot;</span><span class="p">])</span>
<span class="n">r_squared</span>       <span class="o">=</span> <span class="n">covmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">covmat</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">covmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>

<span class="c"># 5- year volatiity and 1-year momentum</span>
<span class="n">volatility</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">covmat</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">momentum</span>        <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">dfsm</span><span class="p">[</span><span class="s">&quot;s_returns&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span>
</pre>
<p>Some caveats about the sample code. The returns are calculated using the
adjusted close from Yahoo finance data. This is because the adjusted close
accounts for dividends and splits etc. In my personal experience I have
found the returns calculated this way to be a reasonably close estimate
but not always accurate. The volatility is calculated here as a simple
standard deviation of the returns. From an option-pricing
model perspective volatility is calculated assuming a log-normal distribution
for the returns.</p>
</div>

  </div>
  <div class="article_meta">
    <p>
	<div style="float:left;width=50%">
		<span class="key">Category:</span> 
		<a href="./category/articles.html">
			<span class="value">articles</span>
		</a>
	</div>
	<div style="float:right;width=50%">
	  <span class="key">Tags:</span>
        <a href="./tag/finance.html">
	      <span class="value">finance</span>
		</a>
,        <a href="./tag/investing.html">
	      <span class="value">investing</span>
		</a>
	</div>
	<div style="clear: both;"></div>
	</p>
	<hr></hr>
  <div>
  <a href="https://twitter.com/share" class="twitter-share-button" data-via="quantspeak">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(! d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
  </script>
  <!-- Google plus share button -->
  <!-- Place this tag where you want the share button to render. -->
  <div class="g-plus" data-action="share" data-annotation="bubble"></div>
  <!-- Place this tag after the last share tag. -->
    <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/platform.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
  </script>
  <!-- end of google plus share-->
  <!-- LinkedIn button -->
  <script src="//platform.linkedin.com/in.js" type="text/javascript">
    lang: en_US
    </script>
  <script type="IN/Share" data-counter="right"></script>
  <!-- end of LinkedIn share -->
    <div id="article_comments" style="display:block">
        <div id="disqus_thread"></div>
        <script type="text/javascript">
           var disqus_identifier = "calculating-stock-beta.html";
           (function() {
           var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
           dsq.src = 'http://karuth.disqus.com/embed.js';
           (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
        </script>
    </div>

</article>

    <footer>
<p><a href="./" class="button_accent">&larr; Back to Index</a></p>
<script language="javascript">
    function toggleComments() {
        var commentDiv = document.getElementById("article_comments");
        (commentDiv.style.display == "none") ? commentDiv.style.display = "block" : commentDiv.style.display = "none";
        return false;
    }
</script>
    </footer>

    <div id="ending_message">
      <p>&copy; Gouthaman Balaraman. Built using <a href="http://getpelican.com" target="_blank">Pelican</a>. Theme by Giulio Fidente on <a href="https://github.com/giulivo/pelican-svbhack" target="_blank">github</a>. .</p>
    </div>
  </main>
</body>
</html>