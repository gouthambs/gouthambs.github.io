<!DOCTYPE html>
<html>
    <head>
        <title>Minimal Lua C++ Example - Gouthaman Balaraman</title>
        <!-- All the meta tags -->
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Minimal Lua C++ Example"/>
        <meta property="og:url" content="http://gouthamanbalaraman.com/blog/minimal-lua-c-example.html"/>
        <meta property="og:description" content="Very basic introduction to Lua C++ API"/>
        <!--link href="http://gouthamanbalaraman.com/theme/static/css/journal-bootstrap.min.css" rel="stylesheet" /-->
        <link href="http://gouthamanbalaraman.com/theme/static/css/bootstrap.readable.min.css" rel="stylesheet" />
        <link href="http://gouthamanbalaraman.com/theme/static/css/style.css" rel="stylesheet" />
        
        <!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-46714334-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    /*Update Your Analytics Tracking Code to Support Display Advertising by uncommenting the following 
    instead of the above line */    
    /*ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';*/
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
        <!-- Using MathJax, with the delimiters $ -->
        <!-- Conflict with pygments for the .mo and .mi -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          "HTML-CSS": {
          styles: {
          ".MathJax .mo, .MathJax .mi": {color: "black ! important"}}
          },
          tex2jax: {inlineMath: [['$','$'], ['\\\\(','\\\\)']],processEscapes: true}
          });
        </script>

        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>

    
    </head>

    <body>
      <div class="navbar navbar-default navbar-fixed-top">
          <div class="container">
            <div class="navbar-header">
              <a href="http://gouthamanbalaraman.com" class="navbar-brand">Gouthaman Balaraman</a>
              <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="navbar-collapse collapse" id="navbar-main">
              <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="http://gouthamanbalaraman.com/pages/about.html">About</a>
                </li>
              </ul>
            </div>
          </div>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1">
    <div class="page-header">
        <h1>Minimal Lua C++ Example</h1>
     <!--span class="glyphicon glyphicon-calendar"></span-->&nbsp;July 17, 2014 
     &nbsp;&nbsp;
     <!--span class="glyphicon glyphicon-user"></span--> by  
     <a class="url fn" href="http://gouthamanbalaraman.com/author/gouthaman-balaraman.html">&nbsp;Gouthaman Balaraman </a>
     </div>
                </div>
            </div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1">

<div class="bs-docs-section">
    
     <!-- article description -->
         <p class="lead">Very basic introduction to Lua C++ API</p>
      
      <!-- article content -->
     <p>If you want to extend and customize the capabilities of a C++ application
without requiring a full recompilation, then using a embedded scripting language
is the way to go. Lua is one such embeddable scripting language, and is very popular
among game developers. The main advantage of Lua, in my opinion, is that the core API
is very minimal, has very small memory footprint. The availability of LuaJIT makes
it a very performant alternative as well.</p>
<div class="section" id="example-code">
<h2>Example Code</h2>
<p>Here is a minimal Lua(V5.1) - C++  example to get one started.</p>
<pre class="code c++ literal-block">
<span class="c1">// luaexample.cpp
</span><span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="p">{</span>
  <span class="cp">#include &quot;lua.h&quot;
</span>  <span class="cp">#include &quot;lualib.h&quot;
</span>  <span class="cp">#include &quot;lauxlib.h&quot;
</span><span class="p">}</span>
<span class="cp">#include &lt;string.h&gt;
</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span><span class="o">*</span> <span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
      <span class="c1">// initialization
</span>      <span class="n">lua_State</span> <span class="o">*</span> <span class="n">L</span> <span class="o">=</span> <span class="n">lua_open</span><span class="p">();</span>
      <span class="n">luaL_openlibs</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>

      <span class="c1">// execute script
</span>      <span class="k">const</span> <span class="kt">char</span> <span class="n">lua_script</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;print('Hello World!')&quot;</span><span class="p">;</span>
      <span class="kt">int</span> <span class="n">load_stat</span> <span class="o">=</span> <span class="n">luaL_loadbuffer</span><span class="p">(</span><span class="n">L</span><span class="p">,</span><span class="n">lua_script</span><span class="p">,</span><span class="n">strlen</span><span class="p">(</span><span class="n">lua_script</span><span class="p">),</span><span class="n">lua_script</span><span class="p">);</span>
      <span class="n">lua_pcall</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

      <span class="c1">// cleanup
</span>      <span class="n">lua_close</span><span class="p">(</span><span class="n">L</span><span class="p">);</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre>
</div>
<div class="section" id="code-explained">
<h2>Code Explained</h2>
<p>Here the <tt class="docutils literal">lua_open</tt> and <tt class="docutils literal">luaL_openlibs</tt> are initialization step in order to prepare
the <tt class="docutils literal">lua_State * L</tt>. We store the script that we need to execute in the variable <tt class="docutils literal">lua_script</tt>.
The <tt class="docutils literal">luaL_loadbuffer</tt> is used to load the script. The loaded script can be executed by
calling <tt class="docutils literal">lua_pcall(L, 0, 0, 0)</tt>. The arguments passed to <tt class="docutils literal">lua_pcall</tt> are the <tt class="docutils literal">lua_State</tt> pointer,
number of arguments to the script (which is none here), number of values returned (which is none here). The
last argument to <tt class="docutils literal">lua_pcall</tt> is the error handler which we will not discuss here.</p>
<p>This needs to be compiled using a C++ compiler and linked to Lua library. When you run the
executable, you should see <tt class="docutils literal">Hello World!</tt> printed on the screen.</p>
</div>
<div class="section" id="conclusion">
<h2>Conclusion</h2>
<p>We looked at a rather simple introductory example of <tt class="docutils literal">lua</tt> interpreter embeded into <tt class="docutils literal">C++</tt> code.</p>
</div>

     <br>
     
     <!-- article tags-->
        <span class="glyphicon glyphicon-tags"></span>&nbsp;&nbsp;
            <span class="label label-default"><a href="http://gouthamanbalaraman.com/tag/lua.html">lua</a></span>&nbsp;&nbsp;
            <span class="label label-default"><a href="http://gouthamanbalaraman.com/tag/programming.html">programming</a></span>&nbsp;&nbsp;
            <span class="label label-default"><a href="http://gouthamanbalaraman.com/tag/c.html">C++</a></span>&nbsp;&nbsp;
        <br>
     <hr/>
    
    <strong>Related Post</strong>
        <ul>
            <li>
                <a href="http://gouthamanbalaraman.com/blog/minimal-example-lua-function-cpp.html">Minimal Example of Calling Lua Functions from C++</a>
            </li>
            <li>
                <a href="http://gouthamanbalaraman.com/blog/sqlalchemy-luigi-workflow-pipeline.html">Using SQLAlchemy in Luigi Workflow Pipeline</a>
            </li>
            <li>
                <a href="http://gouthamanbalaraman.com/blog/flask-app-directory-structure.html">Flask App Directory Structure</a>
            </li>
            <li>
                <a href="http://gouthamanbalaraman.com/blog/zeo-as-a-windows-service.html">Running ZEO as a Windows Service</a>
            </li>
            <li>
                <a href="http://gouthamanbalaraman.com/blog/securing-authentication-tokens.html">Securing Authentication Tokens</a>
            </li>
        </ul>
        <hr/>

     <!-- article comments -->
    <div class="comment">
        <div id="disqus_thread"></div> <!-- comment app container -->
    </div>
	<!-- Comment BEGIN -->
    <script type="text/javascript">
        var disqus_shortname = 'gouthamanbalaramancom'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
     <!-- Comment END -->
</div>    
                </div>
               
            </div>
            <div class="row">
                <div class="col-md-10 col-md-offset-1">
                </div>
            </div>
            <footer id="contentinfo" class="footer">
                    <address id="about" class="vcard body">
                    &copy; <a href="http://gouthamanbalaraman.com">Gouthaman Balaraman</a> Proudly powered by <a href="http://getpelican.com/">Pelican</a>
                    </address><!-- /#about -->
            </footer><!-- /#contentinfo -->
        </div><!-- container -->
    </body>
</html>